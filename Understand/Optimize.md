# 前端性能优化手册

> 从输入 url 到打开页面做了哪些事?

- 浏览器向 DNS 服务器请求，解析 url 的 IP 地址

- 解析到 IP 地址 建立连接(三次握手)

- 浏览器发出读取文件的请求，请求报文作为 TCP 三次握手的第三个报文的数据发送给服务器

- 服务器收到请求后做出响应，并把数据发送给浏览器

- 浏览器收到数据后开始渲染

- 释放连接（四次挥手）

## DNS 缓存

- 浏览器 DNS 缓存

- 本机 DNS 缓存

- 路由器 DNS 缓存

- 运营商 DNS 缓存（80%停在这）

- 递归查询

> 优化策略：尽量使用浏览器缓存 dns-prefetch

## 浏览器发送请求

- 减少 Http 请求数 ，使用前端模块化把文件压缩成一个文件（权衡文件大小）

- 配置懒加载（不需要用到的资源不加载）

- 服务器资源的部署尽量使用同源策略

- 在需要 cookie 辨别多个用户身份的时候尽量用 session,这样只需要传输一个 cookie，节省大量的无效传输

- 使用 preload dns-prefetch prefetch 域请求解析，这种请求不会阻塞浏览器的解析，而是会把资源缓存起来

- 使用 defer 和 async 延迟加载脚本 , async 是谁先加载完就执行谁，会阻塞 dom 的解析， defer 的话等 DOMContentLoad 加载完毕之后才去解析脚本。

## 服务器返回响应，浏览器接受资源

> ngxin

- 配置跨域

- 请求过滤

- 配置 gzip

- 负载均衡

- 静态资源服务器

## 浏览器解析资源渲染

需要阻塞的样式用 Link 引入，

图片多的时候，一定要使用懒加载，图片是最需要优化的，webpack4 也有压缩图片的配置，能极大压缩图片的大小，对于新版浏览器可以使用 webp 格式的图片

将公共的代码抽离，方便缓存 vendor 公共的文件, thunk
